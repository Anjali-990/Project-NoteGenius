{% extends "index.html" %}
{% load static %}
{% block main %}

<section class="upload-section">
  <div class="upload-card" style="max-width: 450px; margin: 0 auto;">
    <h3 class="mb-3">Login to NoteGenius</h3>
    <p class="text-muted mb-4">
      Use your email / mobile and password, or login with OTP.
    </p>

    {% if error %}
    <div class="alert alert-danger">
      {{ error }}
    </div>
    {% endif %}

    <form method="post">
      {% csrf_token %}

      <div class="mb-3 text-start">
        <label class="form-label fw-semibold text-secondary" for="loginId">
          Email or Mobile
        </label>
        <input
          type="text"
          class="form-control"
          id="loginId"
          name="login_id"
          placeholder="Enter your email or mobile"
          required
        />
      </div>

      <!-- Password login -->
      <div class="mb-3 text-start">
        <label class="form-label fw-semibold text-secondary" for="password">
          Password
        </label>
        <input
          type="password"
          class="form-control"
          id="password"
          name="password"
          placeholder="Enter your password"
        />
      </div>

      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="remember"
            name="remember"
          />
          <label class="form-check-label" for="remember">
            Remember me
          </label>
        </div>
        <a href="#" class="small text-decoration-none">Forgot password?</a>
      </div>

      <button type="submit" class="generate-btn w-100 mb-3">
        <i class="fas fa-right-to-bracket me-2"></i>
        Login with password
      </button>

      <hr class="my-3" />

      <!-- OTP login section (frontend) -->
      <div class="mb-2 text-start">
        <label class="form-label fw-semibold text-secondary">
          Or login with OTP
        </label>
        <div class="d-flex gap-2 mb-2">
          <button
            type="button"
            id="loginSendOtp"
            class="btn btn-sm btn-outline-primary"
          >
            Send OTP
          </button>
          <span
            id="loginOtpStatus"
            class="small text-muted align-self-center"
          >
            OTP will be sent to your email / mobile.
          </span>
        </div>

        <input
          type="text"
          class="form-control"
          id="loginOtpInput"
          name="login_otp"
          placeholder="Enter OTP"
          maxlength="6"
          disabled
        />
      </div>

      <button type="button" class="btn btn-outline-secondary w-100 mt-2">
        Login with OTP
      </button>
    </form>

    <p class="mt-3 text-center">
      Don't have an account?
      <a href="{% url 'signup' %}">Sign up</a>
    </p>
  </div>
</section>

<script>
  // FRONTEND ONLY â€“ fake OTP flow for login
  const loginSendOtpBtn = document.getElementById("loginSendOtp");
  const loginOtpInput = document.getElementById("loginOtpInput");
  const loginOtpStatus = document.getElementById("loginOtpStatus");

  if (loginSendOtpBtn) {
    loginSendOtpBtn.addEventListener("click", function () {
      loginOtpInput.disabled = false;
      loginOtpInput.focus();
      loginOtpStatus.textContent =
        "Dummy: OTP sent! (Frontend only, backend baad me connect hoga)";
      loginOtpStatus.classList.remove("text-muted");
      loginOtpStatus.classList.add("text-success");
    });
  }
</script>

{% endblock %}
